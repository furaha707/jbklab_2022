<? include "../include/head.html" ?>
<!DOCTYPE html>
<html lang="<?=$P_lang?>">
	<head>
		<?
    $P_dp1 = '4';

    include "../include/meta.html";

    ?>

    <link rel="stylesheet" href="../../assets/css/inquiry.css" />
	</head>

	<body class="sub-body">
		<? include "../include/header.html" ?>
		<? include "../include/sub-visual.html" ?>
		<? include "../include/sub-nav.html" ?>

		<main class="main sub-main" id="contents">
			<section class="section">
				<div class="container pt-20 pb-30">
					<p class="sub-txt text-center mb-5 font-weight-light text-gray-1">가맹문의를 남겨주시면 상세하게 설명드리겠습니다.</p>

        <?
          $tablename = "tb_inquiry";
          include $_SERVER[DOCUMENT_ROOT]."/INC/tableset.php";
        ?>
          <form id="signform" name="signform" method="POST" ENCTYPE="multipart/form-data" onsubmit="return CheckSignform();">
            <input type="hidden" name="formmode" value="save">
            <input type="hidden" name="mid" id="mid" value="<?=$SITE_USER_MID?>">
            <input type="hidden" name="tablename" value="<?=$tablename?>">
            
            <div class="inquiry-wrap">
              <p class="text-right text-color-1 my-5">* 필수입력</p>
              <table class="table-form-01 type_b border-top-0">
                <colgroup>
                 <col width="15%">
                 <col width="*">
                </colgroup>
                <tbody>
                 <tr>
                  <th>개국여부</th>
                  <td>
                    <select class="sel_for input_for w-lg-33 w-100" name="mode" title="개국여부" id="mode" required onchange="showValue(this)">
                     <option value="">개국여부</option>
                     <option value="1">개국</option>
                     <option value="2">비개국</option>
                     <option value="3">개국예정</option>
                    </select>
                  </td>
                 </tr>
                 <tr>
                  <th>약사님 성함 <span>*</span></th>
                  <td>
                    <input type="text" name="uname" id="uname" title="약사님 성함" maxlength="50" class="input_for w-lg-33 w-100" placeholder="성함을 입력해주세요." required>
                  </td>
                 </tr>
                 <tr>
                  <th>약국명 <span class="storemark">*</span></th>
                  <td>
                    <input type="text" name="title" id="title" title="약국명"  class="input_for w-lg-33 w-100" placeholder="약국명을 입력해주세요." >
                  </td>
                 </tr>
                 <tr>
                  <th>연락처 <span>*</span></th>
                  <td>
                    <input type="tel" name="utel" id="utel" onkeyup="if(isNaN(this.value)) {alert('숫자만 입력해 주세요.');this.value=''};" class="input_for w-lg-33 w-100" placeholder="숫자만 입력해주세요." required>
                  </td>
                 </tr>
                 <tr>
                  <th>이메일 <span>*</span></th>
                  <td>
                    <input type="email" name="uemail" id="uemail" title="이메일" class="input_for w-lg-33 w-100" placeholder="'@'을 포함하여 입력해주세요." required>
                  </td>
                 </tr>
                 <tr>
                  <th>약국주소</th>
                  <td>
                    <div class="addr-wrap">
                      <button type="button" class="addr-btn" onclick="DaumPostcode()">우편번호 검색</button>
                      <input name="uzip" type="hidden" class="FORM1" id="uzip" title="우편번호" size="7" maxlength="7"  value="<?=$row_board[uzip]?>" />
                      <input type="text" name="field_etc_01" id="uaddr1" class="addr addr-1 w-lg-65 w-100" readonly />
                      <input type="text" name="field_etc_02" id="uaddr2" class="addr addr-2 w-lg-35 w-100" placeholder="상세주소" />
                    </div>
                  </td>
                 </tr>
                 <tr>
                  <th>문의내용 <span>*</span></th>
                  <td>
                    <textarea name="content" id="content" title="문의내용" class="area_for" placeholder="문의 내용을 입력해주세요."></textarea>
                    <ul class="clause_list mb-0">
                      <li class="d-flex align-items-center mt-2">
                       <div class="agree_box d-flex align-items-center" style="column-gap: 5px;">
                        <input type="checkbox" name="yark" value="1" id="yark" title="개인정보처리방침에 동의" class="mr_05" required>
                        <label for="yark">개인정보처리방침에 동의합니다.</label>
                       </div>
                       <a href="../pop/privacy.html" class="popup-link font-weight-semibold">[전문보기]</a>
                      </li>
                    </ul>
                  </td>
                 </tr>
                 <tr>
                  <th>
                    <label for="info303" class="font-weight-medium">자동입력 방지코드 <span>*</span></label>
                  </th>
                  <td>
                    <? $r=sprintf('%06d',mt_rand(0,999999));  ?>
                    <input type="hidden" maxlength="100" name="code_org" id="code_org" value="<?=$r?>">
                    <span class="code w-lg-20 text-center"><?=$r?></span>
                    <input type="text" name="imagecode" placeholder="" id="imagecode" title="자동입력방지 코드" class="input_15" required>
                  </td>
                 </tr>
                </tbody>
              </table>
              
              <div class="board_btn_bx text_center mt_30">
                <!-- <a href="../inquiry/inquiry-done.html" class="btn-type-01">가맹문의 접수 <i class="xi-angle-right"></i></a> -->
                <input type="submit" value="가맹문의 접수" class="btn-type-01">
              </div>
            </div>
          </form>

        <script>
        function CheckSignform(){
          // 에디터 있을 경우
          if(document.getElementById("fm_post")){
            myeditor.outputBodyHTML();
          }
          var params = new FormData($('#signform')[0]);

          $.ajax({
            type : 'POST'
            , processData: false
            , contentType: false
            , url : '/lib/board/board_ajax_proc.php'
            , dataType : 'JSON'
            , data : params
            , success : function(res){
              if(res.code!='0'){
                //alert("문의가 접수되었습니다.");
                location.href='./inquiry-done.html';
              }else{
                alert(res.data);
              }
            }
            , beforeSend: function () {
              $('.loading-image').show();
            }
            , complete: function () {
              $('.loading-image').fadeOut(300);
            }
          });
          return false;
        }


        const showValue = (target) => {
				let selecOpt = target.value;
				let storeName = document.getElementById('title');

				if (selecOpt == '1') {
          document.getElementsByClassName('storemark')[0].style.display = 'inline';
					storeName.setAttribute('required', '');
				} else if (selecOpt == '2') {
					document.getElementsByClassName('storemark')[0].style.display = 'none';
					storeName.removeAttribute('required');
				} else if (selecOpt == '3') {
					document.getElementsByClassName('storemark')[0].style.display = 'none';
					storeName.removeAttribute('required');
				}
			};

        </script>					

				
				</div>
			</section>
		</main>

		<? include "../include/footer.html" ?>
		<? include "../include/js.html" ?>

    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
		<script>
      // 우편번호 주소 넣기
      function openZipSearch() {
        new daum.Postcode({
          oncomplete: function(data) {
            // $('[name=zip]').val(data.zonecode); // 우편번호 (5자리)
            $('[name=addr1]').val(data.address);
            $('[name=addr2]').val(data.buildingName);
          }
        }).open();
      }



      function DaumPostcode(uzip="",uaddr1="",uaddr2="") {
        if(uzip=="") uzip = "uzip";
        if(uaddr1=="") uaddr1 = "uaddr1";
        if(uaddr2=="") uaddr2 = "uaddr2";

        daum.postcode.load(function(){
          new daum.Postcode({
            oncomplete: function (data) {
              // 팝업에서 검색결과 항목을 클릭했을때 실행할 코드를 작성하는 부분.

              // 각 주소의 노출 규칙에 따라 주소를 조합한다.
              // 내려오는 변수가 값이 없는 경우엔 공백('')값을 가지므로, 이를 참고하여 분기 한다.
              var fullAddr = ''; // 최종 주소 변수
              var extraAddr = ''; // 조합형 주소 변수

              // 사용자가 선택한 주소 타입에 따라 해당 주소 값을 가져온다.
              if (data.userSelectedType === 'R') { // 사용자가 도로명 주소를 선택했을 경우
                  fullAddr = data.roadAddress;

              } else { // 사용자가 지번 주소를 선택했을 경우(J)
                  fullAddr = data.jibunAddress;
              }

              // 사용자가 선택한 주소가 도로명 타입일때 조합한다.
              if (data.userSelectedType === 'R') {
                  //법정동명이 있을 경우 추가한다.
                  if (data.bname !== '') {
                      extraAddr += data.bname;
                  }
                  // 건물명이 있을 경우 추가한다.
                  if (data.buildingName !== '') {
                      extraAddr += (extraAddr !== '' ? ', ' + data.buildingName : data.buildingName);
                  }
                  // 조합형주소의 유무에 따라 양쪽에 괄호를 추가하여 최종 주소를 만든다.
                  fullAddr += (extraAddr !== '' ? ' (' + extraAddr + ')' : '');
              }

              // 우편번호와 주소 정보를 해당 필드에 넣는다.
              //document.getElementById("uzip1").value = data.postcode1; //6자리 우편번호 사용
              //document.getElementById("uzip2").value = data.postcode2; //6자리 우편번호 사용
              document.getElementById(uzip).value = data.zonecode; //5자리 기초구역번호 사용
              document.getElementById(uaddr1).value = fullAddr;

              // 커서를 상세주소 필드로 이동한다.
              document.getElementById(uaddr2).focus();
            }
          }).open();
        });
      }
    </script>
    </script>
	</body>
</html>
